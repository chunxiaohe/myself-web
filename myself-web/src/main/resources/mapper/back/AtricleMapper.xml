<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sipingsoft.back.mapper.ArticleMapper">

  <resultMap id="BaseResultMap" type="com.sipingsoft.back.entity.Article">
      <id column="id" jdbcType="INTEGER" property="id" />
    <result column="atricle_class_id" jdbcType="INTEGER" property="atricleClassId" />
    <result column="title" jdbcType="VARCHAR" property="title" />
    <result column="keyword" jdbcType="VARCHAR" property="keyword" />
    <result column="content" jdbcType="VARCHAR" property="content" />
    <result column="click" jdbcType="INTEGER" property="click" />
    <result column="is_use" jdbcType="TINYINT" property="isUse" />
    <result column="create_date" jdbcType="TIMESTAMP" property="createDate" />
    <result column="create_by" jdbcType="INTEGER" property="createBy" />
    <result column="update_date" jdbcType="TIMESTAMP" property="updateDate" />
    <result column="is_delete" property="isDelete"/>
    <result column="update_by" jdbcType="INTEGER" property="updateBy" />
      <result property="createName" column="createName"/>
      <result property="updateName" column="updateName"/>
    <association property="articleClass" javaType="com.sipingsoft.back.entity.ArticleClass">
        <result column="type_name" property="typeName"/>
    </association>
  </resultMap>

  <sql id="Base_Column_List">
    art.id, art.atricle_class_id, art.title, art.keyword, art.content, art.click, art.is_use, art.create_date, art.create_by,
    art.update_date, art.update_by
  </sql>

    <sql id="Column_List">
        art.id, art.atricle_class_id, art.title, art.keyword, art.click, art.is_use, art.create_date, art.create_by,
        art.update_date, art.update_by,
        arc.type_name,sysu.name updateName,sysus.name createName
    </sql>

  <select id="findArticleList" parameterType="map" resultMap="BaseResultMap">
    SELECT
      <include refid="Column_List"/>
    FROM article art
    LEFT JOIN article_class arc
    ON art.atricle_class_id = arc.id
    LEFT JOIN sys_user sysu
    ON art.create_by = sysu.user_id
    LEFT JOIN sys_user sysus
    ON art.update_by = sysus.user_id
    <where>
        art.is_delete = 1
        <if test="article.title != null and article.title != null != '' ">
            AND      art.title = #{article.title}
        </if>
        <if test="article.atricleClassId != null and article.atricleClassId != null != ''">
            AND art.atricle_class_id = #{article.atricleClassId}
        </if>
        <if test="article.isUse != null and article.isUse != '' ">
            AND  art.is_use = #{article.isUse}
        </if>
        <if test="article.createDate != null and article.createDate != '' ">
            AND  art.create_date = #{article.createDate}
        </if>
    </where>
    LIMIT #{pageStart},#{pageSize}
  </select>

    <select id="findArticleListConut" parameterType="map" resultType="java.lang.Integer">
      SELECT COUNT(*)
      FROM article
      <where>
            is_delete = 1
          <if test="article.title != null and article.title != null != '' ">
              AND title = #{article.title}
          </if>
          <if test="article.atricleClassId != null and article.atricleClassId != null != ''">
              AND atricle_class_id = #{article.atricleClassId}
          </if>
          <if test="article.isUse != null and article.isUse != '' ">
              AND  is_use = #{article.isUse}
          </if>
          <if test="article.createDate != null and article.createDate != '' ">
              AND  create_date = #{article.createDate}
          </if>
      </where>
    </select>

</mapper>